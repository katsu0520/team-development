# team-development

# 環境構築手順
このプロジェクトの開発環境を以下の手順で構築してください。

---

## 1️⃣ ビルド

まず、アプリケーションをビルドし、コンテナを起動します。

# 1. Dockerイメージをビルド
docker compose build --no-cache

# 2. コンテナを起動
docker compose up -d

# 3. appコンテナに入る
docker compose exec app sh

# 2️⃣ Laravel依存関係をインストール
composer install 

# 3️⃣ 環境設定ファイルの準備
cp .env.example .env 

# 4️⃣ アプリケーションキー生成
php artisan key:generate

# 5️⃣ キャッシュ・設定のクリア
php artisan config:clear                 
php artisan cache:clear
php artisan route:clear
php artisan view:clear

## 6️⃣ Laravelのトップページ確認
ブラウザで http://localhost にアクセスし、Laravelのトップページ（ロゴ表示）を確認してください

## 7️⃣ .envファイルの編集
.env ファイル（src/.env）を以下のように編集します

<pre> ```env DB_CONNECTION=mysql DB_HOST=mysql DB_PORT=3306 DB_DATABASE=org_improvement DB_USERNAME=5igma DB_PASSWORD=password ``` </pre>

OpenAIのapiキーを.envの最後に貼り付けてください
※機密情報保護のため記入していません

## 8️⃣ データベースマイグレーション

下記コマンドでマイグレーションを実行：

# appコンテナに入る（入っていなければ）
docker compose exec app sh

# 設定キャッシュを再構築
php artisan config:clear
php artisan config:cache

# マイグレーションとシーディングを実行
php artisan migrate --seed

## 9️⃣ フロントエンド構築

# nodeコンテナに入る（入っていなければ）
docker compose exec node sh

# 依存パッケージをインストール
npm install

# 開発ビルド
npm run dev

# ログイン画面の確認
ブラウザで以下にアクセスし、ログイン画面が表示されることを確認してください。

[http://localhost/login](http://localhost/login)


**メール送信機能について**
このプロジェクトはSMTP機能を使用しています（ローカル環境専用）。

採点者がアンケートの送信機能をテストする場合は、以下の手順を行ってください。

1️⃣ Googleアカウントの2段階認証を有効化し、**アプリパスワード**を取得  
2️⃣ 取得したアプリパスワードを以下のように `.env` に設定します。

<pre> ```env MAIL_MAILER=smtp MAIL_HOST=smtp.gmail.com MAIL_PORT=587 MAIL_USERNAME=katsuyoshikanado@gmail.com MAIL_PASSWORD=アプリパスワード MAIL_ENCRYPTION=tls MAIL_FROM_ADDRESS="katsuyoshikanado@gmail.com" MAIL_FROM_NAME="BizBuddy" ``` </pre>

# メール送信の動作確認方法
SurveySeeder.php の 74〜90行目にあるコメントアウトを解除してください。

appコンテナで以下を実行します。
php artisan migrate:refresh --seed

seederを回したらアンケートが自動送信されます。

#  補足
シーダーに入っているデータにより、採点者が採点する日程は職場環境改善アンケートの送信日時に含まれています。また、adminアカウントでログインした設定画面でも任意の日付でメールを送信することができます。

**組織環境改善支援プロダクト BizBuddy 使用方法**

# 概要
このプロダクトは、管理職を中心に企業の組織改善を支援するツールです。
アンケートの送付・回収・集計結果の表示、管理職への施策提案や実行支援など、組織改善プロセスを一括でサポートします。

## ログインについて
事前にリンク社と企業の間で契約し、リンク社側（開発側）がアカウントを発行します。
ユーザー登録機能はありません。以下の情報を使ってテストログインを行なってください。

| 役割            | name  | email                                     | password |
| ------------- | ----- | ----------------------------------------- | -------- |
| **企業設定admin** | test0 | [test0@gmail.com](mailto:test0@gmail.com) | password |
| **経営層**       | test1 | [test1@gmail.com](mailto:test1@gmail.com) | password |
| **管理職**       | test2 | [test2@gmail.com](mailto:test2@gmail.com) | password |
| **従業員**       | test3 | [test3@gmail.com](mailto:test3@gmail.com) | password |

- **admin**: 全社アンケートの送付日程を設定するアカウント  
- **executive**: 経営層・人事部向けアカウント  
- **management**: 管理職向けアカウント（テスト環境では部長職）  
- **employee**: 従業員向けアカウント。アンケート回答が可能で、メールでアンケートリンクが送付されます。

## アンケート回答機能（従業員アカウント）
半年に一回全社一斉で職場環境改善アンケートを行います。



半年に一回、全社一斉の職場環境改善アンケートを実施します。  
- **レスポンシブ対応**でスマホでも利用可能  
- 16個の大項目（期待度・満足度の5段階評価）  
- 各大項目に付随する4つの小項目（満足度のみの5段階評価）  
- **自動保存機能**で、途中からの再開が可能です。

> **ポイント**  
> 大項目は「期待度」と「満足度」を二つの観点で評価します。  
> 小項目は「満足度」のみの評価となっています。  
> **want** と記載がある部分は実装優先度の目安です。

## 📊 アンケート集計機能（管理職アカウント）

### 1️⃣ ログイン
`http://localhost/login` から管理職アカウントでログインします。

### 2️⃣ Dashboard の確認
ログイン後、該当部署の集計結果が表示されます。

#### 主要16項目満足度  
- 部署における主要16項目の総合満足度の推移を表示  
- **must**

#### 期待度×満足度ボトルネックスコア  

このプロダクト独自の指標を用いて、組織のボトルネックを特定します。  
主要16項目をそれぞれ5段階で評価し、以下の計算式でスコアを算出します。

<pre> ```plaintext E - S = X （0≦X。0>Xは切り捨て） ``` </pre>

・E: 期待度
・S: 満足度
・X: ボトルネックスコア

スコアXが最も高い大項目が、その組織（部署）のボトルネックとなります。
Dashboardには、部署におけるボトルネックスコアの総和が表示され、これを減らすことが組織改善につながります。

## 期待度×満足度マトリクス

- 縦軸: 期待度（E）  
- 横軸: 期待度・満足度ギャップ（E - S）  
- **右上に近づくほど**: ボトルネック項目  
- **左上に近づくほど**: 組織の優れた項目を示します。

---

### 3️⃣ Analyticsページの利用

1️⃣ 左サイドバーの**上から2番目のアイコン**をクリックして、`analytics` ページにアクセスします。  
- 部署の主要ボトルネック（期待度・満足度・小項目調査結果）が表示されます。  
- **必須機能**（**must**）

2️⃣ 右側の「調査結果詳細」ボタンから、**調査結果詳細ページ**へ遷移します。  
- 設問分類ごとの平均点を一覧で確認できます。  
- **必須機能**（**must**）

3️⃣ 左サイドバーの一番下のアイコン、または `analytics` ページ右下から、**trackingページ（施策タイムライン）** に遷移します。

---

### 4️⃣ 施策立案・実行を支援する機能

施策タイムラインは、施策立案と施策実行を集約し、管理職の組織改善を支援します。

---

#### 🚀 施策の流れ

1️⃣ ボトルネック項目の満足度を基準に、次回アンケートでの満足度向上を目標設定  
- タイムラインには**長期目標設定**と**施策・短期目標設定**のコンポーネントが存在します。

2️⃣ **AI施策提案**  
- ボトルネックの結果を受けて、AIが施策を提案します。  
- **必須機能**（**must**）

3️⃣ **定性情報の追加**  
- 管理職はAIに直接、定性情報を入力して施策精度を向上できます。  
- 空欄でもAIはアンケート結果から施策を提案します。  
- **want**

4️⃣ **Buddyによる提案・改善計画**  
- AIが**3つの組織改善案**を提示し、管理職が1つを選びます。

5️⃣ **パルスサーベイ実行機能**  
- 施策実行を支援し、短期目標は「実施計画の設定」で定めます。  
- **必須機能**（**must**）、**want**

6️⃣ **マイルストーン設定**  
- 次回パルスサーベイまでのマイルストーンを設定できます。

7️⃣ **トラッキング計画設定**  
- パルスサーベイの期間を設定し、「施策計画の確定」ボタンでタイムラインに戻ります。

8️⃣ **タイムライン表示**  
- 先ほど設定したマイルストーンやコンポーネントが表示されます。  
- **必須機能**（**must**）、**want**

9️⃣ **パルスサーベイ結果反映**  
- パルスサーベイ後、調査結果が自動でタイムラインに表示されます。  
- 結果を基に、**施策の継続判断・長期目標の再設定・施策の再設定**が可能です。

10️⃣ **施策継続判断**  
- 「施策を継続する」を選択すると、再び短期目標・マイルストーン・パルスサーベイ設定を行います。

11️⃣ **施策完了後**  
- 次回の職場環境改善アンケート結果と比較し、成果を確認できます。

---

### 5️⃣ 経営層・人事が施策状況を確認する機能

- 経営層アカウントでログインすると、**会社全体のサーベイ結果**が表示されます。  
- 手順は管理職と同様です。

---

# 備考
テストアカウント検証用ログアウト機能: /logout
